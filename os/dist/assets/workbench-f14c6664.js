import{d as B,r as C,D as ce,o as s,f as y,w as o,b as t,a as l,T as Ce,U as Ie,v as W,G as te,V as ze,W as ye,e as T,L as D,I as Qe,l as n,X as K,c as f,F as E,k as G,C as O,Y as re,Z as Ae,$ as et,a0 as tt,a1 as de,a2 as nt,a3 as Re,a4 as ot,a5 as Q,a6 as Ge,a7 as ee,a8 as Pe,a9 as Be,i as U,t as x,j as Z,aa as st,ab as $e,ac as Ye,ad as at,P as ie,H as me,ae as ke,af as le,M as lt,ag as ue,ah as X,p as ve,ai as j,aj as se,ak as it,n as oe,al as He,y as qe,am as fe,an as rt,ao as ct,ap as Me,aq as dt,K as We,ar as De,as as ut,at as _t,au as pt,av as mt,aw as xe,ax as Ke,ay as ft,az as vt,q as gt,aA as ht,E as yt,R as be,aB as we,aC as kt,aD as wt,aE as pe,aF as Le,aG as Ve,aH as Se,aI as Ne,aJ as Te,aK as bt,aL as Ct,aM as It}from"./index-4533c179.js";/* empty css                  *//* empty css               */import{V as $t}from"./vue3-lottie.es-c66b7bf9.js";import{_ as Oe,a as xt}from"./AiChatInfo.vue_vue_type_script_setup_true_lang-aad2daf0.js";/* empty css                     */const Mt=["src"],Dt=["src"],Lt=B({__name:"Detail",props:{id:{}},setup(I){const e=I,m=C("content"),i=ce(()=>"/static/form/index.html?act=userview&dataId="+e.id),a=ce(()=>"/static/workflow/index.html/#/view?id="+e.id);return(r,u)=>{const c=Ce,d=Ie;return s(),y(d,{modelValue:m.value,"onUpdate:modelValue":u[0]||(u[0]=p=>m.value=p),style:{height:"100%"}},{default:o(()=>[t(c,{label:"内容",name:"content"},{default:o(()=>[l("iframe",{src:i.value,frameborder:"0",style:{width:"100%",height:"100%"}},null,8,Mt)]),_:1}),t(c,{label:"流程",name:"flow"},{default:o(()=>[l("iframe",{src:a.value,frameborder:"0",style:{width:"100%",height:"100%"}},null,8,Dt)]),_:1})]),_:1},8,["modelValue"])}}});const Vt=W(Lt,[["__scopeId","data-v-10189be1"]]),St=B({__name:"MyCard",props:{getData:{type:Function},statusList:{},showPagination:{type:Boolean},showFilter:{type:Boolean},filterDate:{},showAction:{type:Boolean},columns:{}},emits:["reset"],setup(I,{expose:e,emit:m}){const i=I,a=C(1),r=C([]),u=C(0),c=C(!1),d=g=>new Date(g*1e3).toLocaleString(),p=async(g,v)=>{c.value=!0;try{let L;v?(console.log(v),L=await i.getData(g,v)):L=await i.getData(g),L.datalist&&L.datalist.forEach(w=>{w.add_time=d(w.add_time),i.statusList&&(w.status=i.statusList[w.status])}),r.value=L.datalist||L.list,u.value=L.total||0}catch(L){console.log(L)}c.value=!1},_=async g=>{a.value=g,i.filterDate?await p(a.value,i.filterDate):await p(a.value)},k=async()=>{await p(a.value,i.filterDate)},h=m,b=async()=>{await h("reset"),a.value=1,await p(a.value,i.filterDate)},$=async()=>{i.filterDate?await p(a.value,i.filterDate):await p(a.value)};return te(async()=>{i.filterDate?await p(a.value,i.filterDate):await p(a.value)}),e({reload:$}),(g,v)=>{const L=O,w=re,z=Ae,Y=et,A=tt,V=de,M=nt,P=Re,H=ot;return s(),y(P,null,ze({header:o(()=>[ye(g.$slots,"title",{},void 0,!0),g.showFilter?(s(),y(z,{key:0,inline:!0},{default:o(()=>[ye(g.$slots,"filter",{},void 0,!0),t(w,null,{default:o(()=>[t(L,{onClick:k,icon:"Search",type:"primary",plain:""},{default:o(()=>v[0]||(v[0]=[T("查询")])),_:1}),t(L,{onClick:b,icon:"RefreshLeft",type:"primary",plain:""},{default:o(()=>v[1]||(v[1]=[T("重置")])),_:1})]),_:1})]),_:3})):D("",!0)]),default:o(()=>[t(V,null,{default:o(()=>[Qe((s(),y(A,{data:r.value,style:{width:"100%"},"show-overflow-tooltip":!n(K)()},{default:o(()=>[(s(!0),f(E,null,G(g.columns,R=>(s(),y(Y,{key:R.prop,prop:R.prop,label:R.label,align:"center"},null,8,["prop","label"]))),128)),g.showAction?(s(),y(Y,{key:0,label:"操作",align:"center"},{default:o(({row:R})=>[ye(g.$slots,"action",{scope:R},void 0,!0)]),_:3})):D("",!0)]),_:3},8,["data","show-overflow-tooltip"])),[[H,c.value]])]),_:3})]),_:2},[g.showPagination?{name:"footer",fn:o(()=>[t(M,{total:u.value,"current-page":a.value,layout:"prev, pager, next",background:"",size:"small",onCurrentChange:_},null,8,["total","current-page"])]),key:"0"}:void 0]),1024)}}});const _e=W(St,[["__scopeId","data-v-8f75d3f5"]]);const Ue=(I,e)=>e?Q("/workflow/datalist?workType=0&knowId=0&limit=10",{page:I,param:"flowId="+e}).then(m=>m.data):Q("/workflow/datalist?workType=0&knowId=0&limit=10",{page:I}).then(m=>m.data),Nt=()=>Q("/workflow/list?workType=0&knowId=0").then(I=>I.data),Tt=()=>Q("/workflow/list?workType=1&knowId=0").then(I=>I.data),Fe=(I,e)=>e?Q("/workflow/datalist?workType=1&knowId=0&limit=10",{page:I,param:"flowId="+e}).then(m=>m.data):Q("/workflow/datalist?workType=1&knowId=0&limit=10",{page:I}).then(m=>m.data),Ut=I=>Q("/workflow/mychecklist?knowId=0&limit=10",{page:I}).then(e=>e.data),Ft=(I,e)=>Q("/workflow/getcopytomelist?&limit=10&knowId=0",{page:I,start_date:e[0],end_date:e[1]}).then(m=>m.data),Et=(I,e)=>Q("/workflow/getcopyfrommelist?&limit=10&knowId=0",{page:I,start_date:e[0],end_date:e[1]}).then(m=>m.data),zt=B({__name:"CopyToMe",emits:["show"],setup(I,{emit:e}){const m=[{prop:"Id",label:"ID"},{prop:"from_nickname",label:"发送者"},{prop:"flowName",label:"流程名"},{prop:"add_time",label:"发送时间"}],i=()=>{let d,p;const _=new Date,k=_.getFullYear(),h=_.getMonth(),b=_.getDate();return h===0?(d=k-1,p=12):(d=k,p=h),{thisMonth:`${k}-${h+1>9?h+1:"0"+(h+1)}-${b>9?b:"0"+b}`,lastMonth:`${d}-${p>9?p:"0"+p}-${b>9?b:"0"+b}`}},a=C([i().lastMonth,i().thisMonth]),r=()=>{a.value=[i().lastMonth,i().thisMonth]},u=e,c=d=>{u("show",{type:"userview",data:d})};return(d,p)=>{const _=Ge,k=re,h=O,b=_e;return s(),y(b,{getData:n(Ft),filterDate:a.value,showAction:!0,showFilter:!0,columns:m,showPagination:!0,onReset:r},{filter:o(()=>[t(k,{label:"日期范围"},{default:o(()=>[t(_,{modelValue:a.value,"onUpdate:modelValue":p[0]||(p[0]=$=>a.value=$),"value-format":"YYYY-MM-DD",type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{width:"200px"}},null,8,["modelValue"])]),_:1})]),action:o(({scope:$})=>[t(h,{size:"small",onClick:g=>c($)},{default:o(()=>p[1]||(p[1]=[T("查看流程信息")])),_:2},1032,["onClick"])]),_:1},8,["getData","filterDate"])}}}),At=B({__name:"MyCheck",props:{reload:{type:Boolean}},emits:["show"],setup(I,{emit:e}){const m=C(),i=I;ee(()=>i.reload,c=>{c&&m.value.reload()});const a=[{prop:"id",label:"ID"},{prop:"userName",label:"发起人"},{prop:"flowName",label:"流程名"},{prop:"add_time",label:"触发时间"}],r=e,u=c=>{r("show",{type:"check",data:c})};return(c,d)=>{const p=O,_=_e;return s(),y(_,{ref_key:"cardRef",ref:m,getData:n(Ut),columns:a,showPagination:!0,showFilter:!1,showAction:!0},{title:o(()=>d[0]||(d[0]=[T("我的审核")])),action:o(({scope:k})=>[t(p,{size:"small",onClick:h=>u(k)},{default:o(()=>d[1]||(d[1]=[T("开始审核")])),_:2},1032,["onClick"])]),_:1},8,["getData"])}}}),Rt=B({__name:"CopyFromMe",emits:["show"],setup(I,{emit:e}){const m=[{prop:"Id",label:"ID"},{prop:"to_nickname",label:"接收者"},{prop:"flowName",label:"流程名"},{prop:"add_time",label:"发送时间"}],i=()=>{let d,p;const _=new Date,k=_.getFullYear(),h=_.getMonth(),b=_.getDate();return h===0?(d=k-1,p=12):(d=k,p=h),{thisMonth:`${k}-${h+1>9?h+1:"0"+(h+1)}-${b>9?b:"0"+b}`,lastMonth:`${d}-${p>9?p:"0"+p}-${b>9?b:"0"+b}`}},a=C([i().lastMonth,i().thisMonth]),r=()=>{a.value=[i().lastMonth,i().thisMonth]},u=e,c=d=>{u("show",{type:"userview",data:d})};return(d,p)=>{const _=Ge,k=re,h=O,b=_e;return s(),y(b,{getData:n(Et),filterDate:a.value,showAction:!0,showFilter:!0,columns:m,showPagination:!0,onReset:r},{filter:o(()=>[t(k,{label:"日期范围"},{default:o(()=>[t(_,{modelValue:a.value,"onUpdate:modelValue":p[0]||(p[0]=$=>a.value=$),"value-format":"YYYY-MM-DD",type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{width:"200px"}},null,8,["modelValue"])]),_:1})]),action:o(({scope:$})=>[t(h,{size:"small",onClick:g=>c($)},{default:o(()=>p[1]||(p[1]=[T("查看流程信息")])),_:2},1032,["onClick"])]),_:1},8,["getData","filterDate"])}}}),Gt=B({__name:"ApplyList",props:{reload:{type:Boolean}},emits:["show"],setup(I,{emit:e}){const m=C(1),i=C([]),a=C(""),r=()=>{a.value=""},u=C(),c=I;ee(()=>c.reload,$=>{$&&u.value.reload()});const d=[{prop:"id",label:"ID"},{prop:"flowName",label:"申请表"},{prop:"status",label:"状态"},{prop:"add_time",label:"发起时间"}],p={0:"未审批",1:"审批中",2:"审批通过",3:"驳回上一节点",4:"审批驳回初始阶段",9:"审批流程已全部通过"},_=async $=>{try{const g=await Ue($);i.value=g.flowlist||[]}catch(g){console.log(g)}},k=e,h=$=>{k("show",{type:"userview",data:$})},b=$=>{k("show",{type:"useredit",data:$})};return te(async()=>{await _(m.value)}),($,g)=>{const v=Pe,L=Be,w=re,z=O,Y=_e;return s(),y(Y,{ref_key:"cardRef",ref:u,getData:n(Ue),statusList:p,columns:d,showPagination:!0,showFilter:!0,filterDate:a.value,showAction:!0,onReset:r},{filter:o(()=>[t(w,null,{default:o(()=>[t(L,{style:{width:"150px"},modelValue:a.value,"onUpdate:modelValue":g[0]||(g[0]=A=>a.value=A),placeholder:"请选择","empty-values":[null,void 0]},{default:o(()=>[t(v,{value:"",label:"全部"}),(s(!0),f(E,null,G(i.value,A=>(s(),y(v,{key:A.id,label:A.name,value:A.flowId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),action:o(({scope:A})=>[t(z,{size:"small",onClick:V=>h(A)},{default:o(()=>g[1]||(g[1]=[T("查看")])),_:2},1032,["onClick"]),A.nodeId==1?(s(),y(z,{key:0,size:"small",onClick:V=>b(A)},{default:o(()=>g[2]||(g[2]=[T("编辑")])),_:2},1032,["onClick"])):D("",!0)]),_:1},8,["getData","filterDate"])}}}),Pt=B({__name:"TaskList",emits:["show"],setup(I,{emit:e}){const m=C(1),i=C([]),a=C(""),r=()=>{a.value=""},u={0:"未审批",1:"审批中",2:"审批通过",3:"驳回上一节点",4:"审批驳回初始阶段",9:"审批流程已全部通过"},c=[{prop:"id",label:"ID"},{prop:"flowName",label:"任务表"},{prop:"status",label:"状态"},{prop:"add_time",label:"添加时间"}],d=async k=>{try{const h=await Fe(k);i.value=h.flowlist||[]}catch(h){console.log(h)}},p=e,_=k=>{p("show",{type:"userview",data:k})};return te(async()=>{await d(m.value)}),(k,h)=>{const b=Pe,$=Be,g=re,v=O,L=_e;return s(),y(L,{getData:n(Fe),statusList:u,columns:c,showPagination:!0,showFilter:!0,showAction:!0,onReset:r},{filter:o(()=>[t(g,null,{default:o(()=>[t($,{style:{width:"150px"},modelValue:a.value,"onUpdate:modelValue":h[0]||(h[0]=w=>a.value=w),placeholder:"请选择","empty-values":[null,void 0]},{default:o(()=>[t(b,{value:"",label:"全部"}),(s(!0),f(E,null,G(i.value,w=>(s(),y(b,{key:w.id,label:w.name,value:w.flowId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),action:o(({scope:w})=>[t(v,{size:"small",onClick:z=>_(w)},{default:o(()=>h[1]||(h[1]=[T("查看")])),_:2},1032,["onClick"])]),_:1},8,["getData"])}}}),Bt={class:"cat-container"},Yt=["onClick"],Ht=["onClick"],qt={class:"cat-items"},Wt=B({__name:"MyApply",emits:["show"],setup(I,{emit:e}){const m=C([]),i=C([]),a=async()=>{try{const c=await Nt();c.list&&c.list.length>0&&c.catList.forEach(d=>{d.workflow_list=c.list.filter(p=>p.cateId===d.id)}),m.value=c.catList||[],i.value=c.list||[]}catch(c){console.log(c)}},r=e,u=c=>{console.log(c),r("show",{type:"useradd",data:c})};return te(async()=>{await a()}),(c,d)=>{const p=U("Star"),_=Z,k=Ce,h=Ie;return s(),y(h,null,{default:o(()=>[t(k,{label:"全部"},{default:o(()=>[l("div",Bt,[(s(!0),f(E,null,G(i.value,b=>(s(),f("div",{class:"cat-items",key:b.id,onClick:$=>u(b)},[t(_,{class:"cat-icon"},{default:o(()=>[t(p)]),_:1}),l("span",null,x(b.name),1)],8,Yt))),128))])]),_:1}),(s(!0),f(E,null,G(m.value,b=>(s(),y(k,{key:b.id,label:b.name},{default:o(()=>[(s(!0),f(E,null,G(b.workflow_list,$=>(s(),f("div",{class:"cat-container",key:$.id,onClick:g=>u($)},[l("div",qt,[t(_,{class:"cat-icon"},{default:o(()=>[t(p)]),_:1}),l("span",null,x($.name),1)])],8,Ht))),128))]),_:2},1032,["label"]))),128))]),_:1})}}});const Kt=W(Wt,[["__scopeId","data-v-496a5ad0"]]),Ot={class:"cat-container"},Jt=["onClick"],Xt=["onClick"],Zt={class:"cat-items"},jt=B({__name:"MyTask",emits:["show"],setup(I,{emit:e}){const m=C([]),i=C([]),a=async()=>{try{const c=await Tt();c.list&&c.list.length>0&&c.catList.forEach(d=>{d.workflow_list=c.list.filter(p=>p.cateId===d.id)}),m.value=c.catList||[],i.value=c.list||[]}catch(c){console.log(c)}},r=e,u=c=>{console.log(c),r("show",{type:"useradd",data:c})};return te(async()=>{await a()}),(c,d)=>{const p=U("Star"),_=Z,k=Ce,h=Ie;return s(),y(h,null,{default:o(()=>[t(k,{label:"全部"},{default:o(()=>[l("div",Ot,[(s(!0),f(E,null,G(i.value,b=>(s(),f("div",{class:"cat-items",key:b.id,onClick:$=>u(b)},[t(_,{class:"cat-icon"},{default:o(()=>[t(p)]),_:1}),l("span",null,x(b.name),1)],8,Jt))),128))])]),_:1}),(s(!0),f(E,null,G(m.value,b=>(s(),y(k,{key:b.id,label:b.name},{default:o(()=>[(s(!0),f(E,null,G(b.workflow_list,$=>(s(),f("div",{class:"cat-container",key:$.id,onClick:g=>u($)},[l("div",Zt,[t(_,{class:"cat-icon"},{default:o(()=>[t(p)]),_:1}),l("span",null,x($.name),1)])],8,Xt))),128))]),_:2},1032,["label"]))),128))]),_:1})}}});const Qt=W(jt,[["__scopeId","data-v-f4ce2368"]]),Je=st("worktable",()=>{const I=C("0");return{currentTab:I,setCurrentTab:m=>{I.value=m}}}),en={style:{width:"100%",height:"100%"}},tn=["src"],nn=B({__name:"WorkTableMain",setup(I){const e=Je(),m=C(!1),i=C(!1),a=C(""),r=C(""),u=C("");ee(m,_=>{_||(a.value="",i.value=!1)});const c=_=>{m.value=!0,_.type=="userview"?(r.value="查看数据-"+_.data.flowName,i.value=!0,u.value=_.data.id):_.type=="useradd"?(r.value="新增数据-"+_.data.name,a.value="/static/form/index.html?act=useradd&flowId="+_.data.id):_.type=="check"?(r.value="审批数据-"+_.data.flowName,a.value="/views/desktop/mycheckaction.html?formdataId="+_.data.dataId+"&flowcheckId="+_.data.id+"&id="+_.data.id):_.type=="useredit"&&(r.value="编辑数据-"+_.data.flowName,a.value="/static/form/index.html?act=useredit&dataId="+_.data.id)},d=C(!1),p=C(!1);return te(()=>{window.addEventListener("message",_=>{d.value=!1,p.value=!1,_.data=="reloadCheck"?d.value=!0:_.data=="reloadApplyList"&&(p.value=!0),_.data=="closeDialog"&&(m.value=!1)},!1)}),(_,k)=>{const h=Qt,b=Kt,$=Pt,g=Gt,v=Rt,L=At,w=zt,z=Vt,Y=$e;return s(),f("div",en,[n(e).currentTab==="0"?(s(),y(h,{key:0,onShow:c})):D("",!0),n(e).currentTab==="1"?(s(),y(b,{key:1,onShow:c})):D("",!0),n(e).currentTab==="2"?(s(),y($,{key:2,onShow:c})):D("",!0),n(e).currentTab==="3"?(s(),y(g,{key:3,reload:p.value,onShow:c},null,8,["reload"])):D("",!0),n(e).currentTab==="4"?(s(),y(v,{key:4,onShow:c})):D("",!0),n(e).currentTab==="5"?(s(),y(L,{key:5,reload:d.value,onShow:c},null,8,["reload"])):D("",!0),n(e).currentTab==="6"?(s(),y(w,{key:6,onShow:c})):D("",!0),t(Y,{modelValue:m.value,"onUpdate:modelValue":k[0]||(k[0]=A=>m.value=A),size:"95%",title:r.value},{default:o(()=>[i.value?(s(),y(z,{key:0,id:u.value},null,8,["id"])):(s(),f("iframe",{key:1,src:a.value,frameborder:"0",style:{width:"100%",height:"95%"}},null,8,tn))]),_:1},8,["modelValue","title"])])}}});const on=W(nn,[["__scopeId","data-v-2b3d19fa"]]),sn={class:"chat-bot"},an={class:"top-menu"},ln={class:"messsage-area"},rn={key:1,class:"no-message-container"},cn={class:"input-area"},dn={class:"input-panel"},un=B({__name:"AiChatMain",props:{win:{}},setup(I){const e=Ye(),m=at(),i=C(!1),a=C(!1),r=C(null);let u=C(""),c=C(""),d=C("");const p=C(),_=C(),k=C(""),h=C(0),b=I,$=ce(()=>[{content:e.chatInfo.prompt||"",chatType:"chat",chatId:e.activeId,role:"system",id:Date.now(),createAt:Date.now()}]);te(async()=>{var V,M;h.value=((M=(V=b.win)==null?void 0:V.props)==null?void 0:M.knowledgeId)||0,console.log(h.value,"knowledgeId"),await e.initChat(h.value)});const g=ce(()=>{const V=m.chatConfig.chat.contextLength;if(e.messageList.length<=V)return[...$.value,...e.messageList];{const M=e.messageList.slice(-V);return[...$.value,...M]}}),v=async()=>{if(e.activeId<1){le(ke("aichat.selectModel"));return}if(k.value.trim()){if(i.value===!0)return;let V={content:k.value,chatId:e.activeId,role:"user",id:Date.now(),createdAt:Date.now()};e.messageList.push(V),await e.addMessages(e.activeId,V),k.value="",i.value=!0,await L()}},L=async()=>{try{const V=Date.now(),M={content:"",role:"assistant",chatType:"chat",chatId:e.activeId,id:V,createdAt:V},P=m.chatConfig.chat,H=e.chatInfo.knowledgeId*1;let R={messages:g.value,model:e.chatInfo.model,engine:e.chatInfo.engine,stream:!1,webSearch:a.value,fileContent:c.value,fileName:d.value,knowledgeId:H};if(u.value!=""){const J=await m.getModel("img2txt"),F=e.messageList[e.messageList.length-1];R={model:J.model,engine:J.info.engine,stream:!1,webSearch:!1,options:P,messages:[{role:"user",content:F.content,images:[u.value]}],knowledgeId:H}}const S=await m.chatWithModel(R);if(console.log(S),u.value="",c.value="",d.value="",!S){le("模型调用失败，请稍后重试！"),i.value=!1;return}if(console.log(S),S&&S.choices&&S.choices.length>0&&S.choices[0].message.content){const J=S.choices[0].message.content;M.content=J,S.documents&&S.documents.length>0&&(M.doc=S.documents),S.web_search&&S.web_search.length>0&&(M.web_search=S.web_search),e.messageList.push(M),await e.addMessages(e.activeId,M)}S&&S.message&&(S.message.content.startsWith(`<think>

</think>

`)&&(S.message.content=S.message.content.replace(`<think>

</think>

`,"")),M.content=S.message.content,e.messageList.push(M),await e.addMessages(e.activeId,M)),i.value=!1}catch(V){i.value=!1,le(V.message)}},w=()=>{lt(()=>{p&&p.value&&p.value.setScrollTop(_.value.clientHeight)})};ee(()=>e.messageList,()=>{w()},{deep:!0});const z=V=>{V.key==="Enter"&&(V.altKey||V.shiftKey)?(V.preventDefault(),k.value+=`
`):V.key==="Enter"&&(V.preventDefault(),v())},Y=async()=>{r.value.click()},A=async V=>{const M=V.target.files[0];if(!M)return;if(M.type.startsWith("image/")&&!await m.getModel("img2txt")){le(ke("aichat.notEyeModel"));return}const P=new FileReader;P.onload=H=>{const R=H.target.result.split(",")[1];M.type.startsWith("image/")?u.value=R:(c.value=R,d.value=M.name)},P.readAsDataURL(M)};return(V,M)=>{const P=Oe,H=ue,R=U("Tools"),S=Z,J=U("DeleteFilled"),F=xt,ne=O,ae=X,ge=ve,he=j;return s(),f(E,null,[t(H,{modelValue:n(e).showInfo,"onUpdate:modelValue":M[0]||(M[0]=q=>n(e).showInfo=q),width:"600","append-to-body":"",fullscreen:!!n(K)()},{default:o(()=>[t(P)]),_:1},8,["modelValue","fullscreen"]),l("div",sn,[l("div",an,[t(S,{size:"15",onClick:M[1]||(M[1]=ie(q=>n(e).showBox(!0),["stop"])),class:"top-menu-button"},{default:o(()=>[t(R)]),_:1}),t(S,{size:"15",onClick:ie(n(e).clearChatHistory,["stop"]),class:"top-menu-button"},{default:o(()=>[t(J)]),_:1},8,["onClick"])]),l("div",ln,[t(n(de),{class:"message-container",ref_key:"messageContainerRef",ref:p},{default:o(()=>[n(e).messageList.length>0?(s(),f("div",{key:0,ref_key:"messageInnerRef",ref:_},[(s(!0),f(E,null,G(n(e).messageList,q=>(s(),y(F,{key:q.messageId,content:q.content,link:q.link,role:q.role,createdAt:q.createdAt,doc:q.doc||[],web_search:q.web_search||[]},null,8,["content","link","role","createdAt","doc","web_search"]))),128))],512)):(s(),f("div",rn,[t(n($t),{animationLink:"/bot/chat.json",height:420,width:420})]))]),_:1},512),l("div",cn,[l("div",dn,[t(he,{gutter:24,style:{"border-bottom":"none"}},{default:o(()=>[t(ae,{span:2},{default:o(()=>[t(ne,{class:me(["file-btn",{"selected-image":n(u)!=""||n(c)!=""}]),onClick:Y,size:"large",icon:"Paperclip",circle:""},null,8,["class"]),l("input",{type:"file",ref_key:"imageInput",ref:r,accept:"image/*,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/pdf",style:{display:"none"},onChange:A},null,544)]),_:1}),t(ae,{span:2},{default:o(()=>[t(ne,{class:"websearch-btn",onClick:M[2]||(M[2]=q=>a.value=!a.value),size:"large",icon:"ChromeFilled",circle:"",type:a.value?"primary":"default"},null,8,["type"])]),_:1}),t(ae,{span:17},{default:o(()=>[t(ge,{modelValue:k.value,"onUpdate:modelValue":M[3]||(M[3]=q=>k.value=q),placeholder:n(ke)("aichat.askme"),size:"large",clearable:"",onKeydown:z,autofocus:!n(K)(),class:"ai-input-area"},null,8,["modelValue","placeholder","autofocus"])]),_:1}),t(ae,{span:2},{default:o(()=>[i.value?(s(),y(ne,{key:1,type:"danger",size:"large","loading-icon":"Eleme",icon:"Loading",loading:"",circle:""})):(s(),y(ne,{key:0,onClick:v,icon:"Promotion",type:"primary",size:"large",circle:""}))]),_:1})]),_:1})])])])])],64)}}});const _n=W(un,[["__scopeId","data-v-a3b08f45"]]);const pn={key:0,class:"chat-user-info"},mn={key:0,class:"user-content"},fn={class:"user-details"},vn={class:"avatar"},gn={key:1,class:"group-content"},hn={class:"group-details"},yn={class:"group-avatar"},kn={class:"avatar-container"},wn={class:"send-button-container"},bn={key:1,class:"empty-container"},Cn=B({__name:"ChatUserInfo",setup(I){const e=se(),m=(i,a)=>{e.currentNavId=0,e.getGroupMemberList(i),e.addChatListAndGetChatHistory(i,a)};return(i,a)=>{const r=oe,u=O,c=He;return n(e).targetChatId?(s(),f("div",pn,[n(e).targetUserInfo&&Object.keys(n(e).targetUserInfo).length>0?(s(),f("div",mn,[l("div",fn,[l("h2",null,x(n(e).targetUserInfo.displayName),1),l("p",null,"工号："+x(n(e).targetUserInfo.jobNumber||"暂未设置"),1),l("p",null,"岗位："+x(n(e).targetUserInfo.desc||"暂未设置"),1),l("p",null,"邮箱："+x(n(e).targetUserInfo.email||"暂未设置"),1),l("p",null,"电话："+x(n(e).targetUserInfo.phone||"暂未设置"),1),l("p",null,"入职日期："+x(n(e).targetUserInfo.hiredDate||"暂未设置"),1)]),l("div",vn,[t(r,{style:{width:"80px",height:"80px"},src:n(e).targetUserInfo.avatar||n(it),alt:"avatar"},null,8,["src"])])])):n(e).targetGroupInfo&&Object.keys(n(e).targetGroupInfo).length>0?(s(),f("div",gn,[l("div",hn,[l("h2",null,x(n(e).targetGroupInfo.displayName),1),l("p",null,"群ID："+x(n(e).targetGroupInfo.chatId),1),l("p",null,"群人数："+x(n(e).targetGroupInfo.memberCount)+"人",1),l("p",null,"创建时间："+x(n(e).targetGroupInfo.createdAt),1)]),l("div",yn,[l("div",kn,[t(r,{style:{width:"80px",height:"80px"},src:n(e).targetGroupInfo.avatar,alt:"group-avatar"},null,8,["src"])])])])):D("",!0),a[2]||(a[2]=l("div",{class:"divider"},null,-1)),l("div",wn,[t(u,{type:"primary",onClick:a[0]||(a[0]=d=>{var p;return m(((p=n(e).targetGroupInfo)==null?void 0:p.chatId)||n(e).targetUserInfo.chatId,n(e).targetGroupInfo?"group":n(e).targetUserInfo.type)})},{default:o(()=>a[1]||(a[1]=[T(" 发送消息 ")])),_:1})])])):(s(),f("div",bn,[t(c,{description:"请选择一个用户或群聊"})]))}}});const In=W(Cn,[["__scopeId","data-v-8133e033"]]);function Ee(I){const e=new Date(Number(I)),m=e.getMonth()+1,i=e.getDate(),a=e.getHours(),r=e.getMinutes(),u=a.toString().padStart(2,"0"),c=r.toString().padStart(2,"0");return`${m}-${i} ${u}:${c}`}function $n(I){const e=new Date(I),m=e.getFullYear(),i=(e.getMonth()+1).toString().padStart(2,"0"),a=e.getDate().toString().padStart(2,"0"),r=e.getHours().toString().padStart(2,"0"),u=e.getMinutes().toString().padStart(2,"0"),c=e.getSeconds().toString().padStart(2,"0");return`${m}-${i}-${a} ${r}:${u}:${c}`}const xn={key:0,class:"system-message"},Mn={key:1},Dn={key:0,class:"chat-item"},Ln={class:"chat-name-me"},Vn=["onContextmenu"],Sn={key:0,class:"chat-font"},Nn=["onClick"],Tn={class:"chat-item-file-icon"},Un={class:"chat-item-file-name"},Fn={key:2,class:""},En={class:"chat-time-me-outer"},zn={class:"chat-avatar"},An={key:1,class:"chat-item"},Rn={class:"chat-avatar"},Gn={class:"chat-name-other"},Pn={class:"bubble-other"},Bn={key:0,class:"chat-font"},Yn=["onClick"],Hn={class:"chat-item-file-icon"},qn={class:"chat-item-file-name"},Wn={key:2,class:""},Kn={class:"chat-time-other-outer"},On={class:"user-content"},Jn={class:"user-details"},Xn=B({__name:"ChatMessage",setup(I){const e=se(),m=qe(),i=C(!1),a=C({}),r=C(),u=d=>{r.value=d,a.value=e.groupMembers.find(p=>p.id===d),i.value=!0},c=()=>{if(r.value==e.userInfo.id){rt("不能给自己发送消息");return}e.getSessionInfo(r.value,"user"),i.value=!1};return(d,p)=>{const _=X,k=j,h=U("Document"),b=Z,$=ct,g=oe,v=O,L=ue;return s(),f(E,null,[n(e).chatHistory&&n(e).chatHistory.length>0?(s(!0),f(E,{key:0},G(n(e).chatHistory,w=>(s(),f("div",{style:{"margin-top":"10px"},key:w.chatId},[w.content_type=="invite_group_message"?(s(),f("div",xn,x(w.message),1)):(s(),f("div",Mn,[w.isMe?(s(),f("div",Dn,[t(k,null,{default:o(()=>[t(_,{span:8}),t(_,{span:14},{default:o(()=>[t(k,null,{default:o(()=>[t(_,{span:24},{default:o(()=>[l("div",Ln,x(n(e).userInfo.nickname),1)]),_:1})]),_:1}),l("div",{class:"bubble-me",onContextmenu:ie(z=>n(e).showContextMenu(z,w.chatId),["prevent"])},[w.content_type=="text"?(s(),f("div",Sn,x(w.message),1)):w.content_type=="file"?(s(),f("div",{key:1,onClick:z=>n(m).openFile(w.file_path),class:me(["chat-item-file","file-me"])},[l("div",Tn,[t(b,{size:"30",color:"#303133"},{default:o(()=>[t(h)]),_:1})]),l("div",Un,x(w.file_name),1)],8,Nn)):w.content_type=="image"?(s(),f("div",Fn,[t($,{fit:"cover",loading:"lazy","preview-src-list":[w.message],src:w.message},null,8,["preview-src-list","src"])])):D("",!0)],40,Vn),l("div",En,x(n(Ee)(w.createdAt)),1)]),_:2},1024),t(_,{span:2},{default:o(()=>[l("div",zn,[t(g,{onClick:z=>u(w.userId),shape:"square",style:{margin:"0",float:"left"},size:32,class:"userAvatar",src:w.avatar},null,8,["onClick","src"])])]),_:2},1024)]),_:2},1024)])):(s(),f("div",An,[t(k,null,{default:o(()=>[t(_,{span:2},{default:o(()=>[l("div",Rn,[t(g,{onClick:z=>u(w.userId),shape:"square",style:{margin:"0",float:"right"},size:32,class:"userAvatar",src:w.avatar},null,8,["onClick","src"])])]),_:2},1024),t(_,{span:14},{default:o(()=>[t(k,null,{default:o(()=>[t(_,{span:24},{default:o(()=>[l("div",Gn,x(w.displayName),1)]),_:2},1024)]),_:2},1024),l("div",Pn,[w.content_type=="text"?(s(),f("div",Bn,x(w.message),1)):w.content_type=="file"?(s(),f("div",{key:1,onClick:z=>n(m).openFile(w.message),class:me(["chat-item-file","file-other"])},[l("div",Hn,[t(b,{size:"30",color:"#303133"},{default:o(()=>[t(h)]),_:1})]),l("div",qn,x(w.file_name),1)],8,Yn)):w.content_type=="image"?(s(),f("div",Wn,[t($,{fit:"cover",loading:"lazy","preview-src-list":[w.message],src:w.message},null,8,["preview-src-list","src"])])):D("",!0)]),l("div",Kn,x(n(Ee)(w.createdAt)),1)]),_:2},1024),t(_,{span:8})]),_:2},1024)]))]))]))),128)):D("",!0),n(e).contextMenu.visible?(s(),f("div",{key:1,class:"context-menu",style:fe({top:`${n(e).contextMenu.y}px`,left:`${n(e).contextMenu.x}px`})},[(s(!0),f(E,null,G(n(e).contextMenu.list,w=>(s(),f("div",{key:w.id,class:"context-menu-item"},[l("div",{class:"context-menu-item-font",onClick:p[0]||(p[0]=z=>n(e).handleContextMenu())},x(w.label),1)]))),128))],4)):D("",!0),t(L,{style:{"border-radius":"10px"},modelValue:i.value,"onUpdate:modelValue":p[1]||(p[1]=w=>i.value=w),title:"用户信息",width:"300"},{default:o(()=>[l("div",On,[l("div",Jn,[l("h3",null,x(a.value.displayName),1),l("p",null,"工号："+x(a.value.jobNumber),1),l("p",null,"岗位："+x(a.value.desc),1),l("p",null,"邮箱："+x(a.value.email),1),l("p",null,"电话："+x(a.value.phone),1),l("p",null,"入职日期："+x(a.value.hiredDate),1)])]),t(v,{onClick:c,class:"send-button-container"},{default:o(()=>p[2]||(p[2]=[T("发送消息")])),_:1})]),_:1},8,["modelValue"])],64)}}});const Zn=W(Xn,[["__scopeId","data-v-93ef9c43"]]);const jn={class:"group-member-container"},Qn={class:"member-item"},eo={class:"avatar-container"},to={key:0,class:"chatbox-main"},no={class:"header-title"},oo={key:0,class:"header-title-name"},so={key:1,class:"header-title-name"},ao={key:2},lo={style:{display:"flex",gap:"10px"}},io={key:3,class:"chat-dropdown-menu"},ro={class:"msg-container"},co={class:"input-main"},uo={key:1,class:"chatbox-main"},_o={class:"header-title"},po={key:0,class:"header-title-name"},mo={class:"chat-dropdown-menu"},fo={class:"msg-container"},vo={class:"msg-time"},go={key:2,class:"empty-chatbox"},ho=B({__name:"ChatBoxMain",setup(I){const e=se(),m=qe(),i=["png","jpg","jpeg","gif","bmp","webp","svg"],a=C(""),r=C(null),u=C(null),c=g=>{g==="user"?e.clearSentMessages()?e.clearReceivedMessages()?(De("删除成功"),e.getSessionInfo(e.targetChatId,g)):le("删除失败"):e.clearReceivedMessages()?De("删除成功"):le("删除失败"):g==="group"?e.clearGroupMessages():g==="system"&&e.clearSystemMessages()},d=()=>{e.inviteFriendDialogVisible=!0,e.getInviteUserList()};function p(){e.setScrollToBottom(u,r)}const _=()=>e.inviteUserList.map(g=>({key:g.id,label:g.nickname,avatar:g.avatar})),k=C([]);Me(()=>{e.inviteUserList&&e.inviteUserList.length>0&&(k.value=_())});const h=C([]);Me(()=>{e.allUserList.length>0&&(k.value=_())}),ee(()=>e.messageSendStatus,(g,v)=>{console.log("messageSendStatus 变化了:",g),g&&(console.log("messageSendStatus 变化了:",g),p())}),ee(()=>e.messageReceiveStatus,(g,v)=>{g&&p()}),ee(()=>e.drawerVisible,(g,v)=>{g&&e.getGroupMember(e.targetGroupInfo.group_id)});function b(){console.log(a.value),m.chooseFiles(i)}function $(){a.value="applyfile",m.chooseFiles(["*"])}return ee(()=>m.choose.paths,g=>{g&&g.length>0&&(e.sendInfo=dt(m.choose.paths),e.sendMessage(a.value),m.clearChoose())}),(g,v)=>{const L=oe,w=ut,z=O,Y=ue,A=$e,V=U("More"),M=Z,P=_t,H=pt,R=mt,S=xe,J=Zn,F=de,ne=Ke,ae=U("Picture"),ge=U("Link"),he=U("Promotion"),q=ve,Xe=ft,Ze=Re,je=He;return s(),f(E,null,[t(Y,{modelValue:n(e).inviteFriendDialogVisible,"onUpdate:modelValue":v[3]||(v[3]=N=>n(e).inviteFriendDialogVisible=N),title:"邀请群聊",width:"80%",style:{height:"450px"},"align-center":""},{default:o(()=>[l("div",null,[t(w,{titles:["可选项","已选项"],filterable:"","filter-placeholder":"搜索用户名",style:{height:"300px"},modelValue:h.value,"onUpdate:modelValue":v[0]||(v[0]=N=>h.value=N),data:k.value,props:{key:"key",label:"label",avatar:"avatar"}},{default:o(({option:N})=>[t(L,{src:N.avatar,size:"small",style:{"margin-right":"5px"}},null,8,["src"]),l("span",null,x(N.label),1)]),_:1},8,["modelValue","data"]),t(z,{class:"chat-canel-button",onClick:v[1]||(v[1]=N=>n(e).inviteFriendDialogVisible=!1)},{default:o(()=>v[14]||(v[14]=[T("取消")])),_:1}),t(z,{onClick:v[2]||(v[2]=N=>n(e).inviteFriend(n(e).targetGroupInfo.group_id,h.value)),class:"invite-group-button",style:{}},{default:o(()=>v[15]||(v[15]=[T("确定")])),_:1})])]),_:1},8,["modelValue"]),t(A,{modelValue:n(e).groupMemberDrawerVisible,"onUpdate:modelValue":v[4]||(v[4]=N=>n(e).groupMemberDrawerVisible=N),direction:"rtl",title:"群成员","with-header":!0,"show-close":!0,size:"250px"},{default:o(()=>[l("div",jn,[(s(!0),f(E,null,G(n(e).groupMembers,N=>(s(),f("div",{class:"member-list",key:N.id},[l("div",Qn,[l("div",eo,[t(L,{style:{width:"100%",height:"100%"},src:N.avatar},null,8,["src"])]),l("span",null,x(N.nickname),1)])]))),128))])]),_:1},8,["modelValue"]),n(e).targetChatType==="user"||n(e).targetChatType==="group"?(s(),f("div",to,[t(S,{class:"chat-header"},{default:o(()=>[l("div",no,[n(e).targetUserInfo.displayName?(s(),f("span",oo,x(n(e).targetUserInfo.displayName),1)):n(e).targetGroupInfo.displayName?(s(),f("span",so,x(n(e).targetGroupInfo.displayName),1)):D("",!0),n(e).targetGroupInfo&&Object.keys(n(e).targetGroupInfo).length>0?(s(),f("div",ao,[l("div",lo,[t(R,{placement:"bottom",style:{border:"none"}},{dropdown:o(()=>[t(H,null,{default:o(()=>[t(P,{onClick:v[5]||(v[5]=N=>n(e).groupMemberDrawerVisible=!0)},{default:o(()=>v[16]||(v[16]=[T("群成员")])),_:1}),t(P,{onClick:v[6]||(v[6]=N=>d())},{default:o(()=>v[17]||(v[17]=[T("邀请群聊")])),_:1}),t(P,{onClick:v[7]||(v[7]=N=>n(e).quitGroup(n(e).targetGroupInfo.group_id))},{default:o(()=>v[18]||(v[18]=[T("退出群聊")])),_:1}),t(P,{onClick:v[8]||(v[8]=N=>c("group"))},{default:o(()=>v[19]||(v[19]=[T("清空记录")])),_:1})]),_:1})]),default:o(()=>[t(M,{class:"chat-dropdown-icon"},{default:o(()=>[t(V)]),_:1})]),_:1})])])):(s(),f("div",io,[t(R,null,{dropdown:o(()=>[t(H,null,{default:o(()=>[t(P,{onClick:v[9]||(v[9]=N=>c("user"))},{default:o(()=>v[20]||(v[20]=[T("清空记录")])),_:1})]),_:1})]),default:o(()=>[t(M,{class:"chat-dropdown-icon"},{default:o(()=>[t(V)]),_:1})]),_:1})]))])]),_:1}),t(ne,{class:"msg-main"},{default:o(()=>[l("div",ro,[t(F,{ref_key:"scrollbarRef",ref:r},{default:o(()=>[l("div",{ref_key:"innerRef",ref:u},[t(J)],512)]),_:1},512)])]),_:1}),t(Xe,{class:"msg-footer"},{default:o(()=>[l("div",co,[t(q,{size:"large",style:{width:"100%",height:"100%"},placeholder:"请输入内容",onKeyup:v[11]||(v[11]=We(ie(N=>n(e).sendMessage("text"),["exact"]),["enter"])),modelValue:n(e).message,"onUpdate:modelValue":v[12]||(v[12]=N=>n(e).message=N)},{suffix:o(()=>[t(M,{size:20,class:"input-option-icon",onClick:b},{default:o(()=>[t(ae)]),_:1}),t(M,{size:20,class:"input-option-icon",onClick:$},{default:o(()=>[t(ge)]),_:1}),t(M,{onClick:v[10]||(v[10]=N=>n(e).sendMessage("text")),size:22,class:"input-button"},{default:o(()=>[t(he)]),_:1})]),_:1},8,["modelValue"])])]),_:1})])):D("",!0),n(e).targetChatType==="system"?(s(),f("div",uo,[t(S,{class:"chat-header"},{default:o(()=>[l("div",_o,[n(e).systemInfo?(s(),f("span",po,"系统消息")):D("",!0),l("div",mo,[t(R,null,{dropdown:o(()=>[t(H,null,{default:o(()=>[t(P,{onClick:v[13]||(v[13]=N=>c("system"))},{default:o(()=>v[21]||(v[21]=[T("清空记录")])),_:1})]),_:1})]),default:o(()=>[t(M,{class:"chat-dropdown-icon"},{default:o(()=>[t(V)]),_:1})]),_:1})])])]),_:1}),t(ne,{class:"system-main"},{default:o(()=>[l("div",fo,[t(F,{ref_key:"scrollbarRef",ref:r},{default:o(()=>[l("div",{ref_key:"innerRef",ref:u},[(s(!0),f(E,null,G(n(e).systemInfo,N=>(s(),f("div",{class:"msg-card",key:N.id},[l("div",vo,x(n($n)(N.time)),1),t(Ze,{class:"box-card"},{default:o(()=>[T(x(N.previewMessage),1)]),_:2},1024)]))),128))],512)]),_:1},512)])]),_:1})])):D("",!0),n(e).targetChatType?D("",!0):(s(),f("div",go,[t(je,{description:"请选择一个用户或群聊"})]))],64)}}});const yo=W(ho,[["__scopeId","data-v-562a8a9f"]]);const ko=B({__name:"WorkTableLeft",setup(I){const e=["my","approval"],m=Je();return(i,a)=>{const r=U("UserFilled"),u=Z,c=U("Compass"),d=gt,p=U("Open"),_=U("Tickets"),k=U("Memo"),h=U("Files"),b=ht,$=U("Reading"),g=U("Postcard"),v=yt;return s(),y(v,{class:"el-menu-vertical-demo","default-openeds":e,"default-active":n(m).currentTab},{default:o(()=>[t(b,{index:"my"},{title:o(()=>[t(u,null,{default:o(()=>[t(r)]),_:1}),a[7]||(a[7]=l("span",null,"我的",-1))]),default:o(()=>[t(d,{index:"0",onClick:a[0]||(a[0]=L=>n(m).setCurrentTab("0"))},{default:o(()=>[t(u,null,{default:o(()=>[t(c)]),_:1}),a[8]||(a[8]=l("span",null,"我的任务",-1))]),_:1}),t(d,{index:"1",onClick:a[1]||(a[1]=L=>n(m).setCurrentTab("1"))},{default:o(()=>[t(u,null,{default:o(()=>[t(p)]),_:1}),a[9]||(a[9]=l("span",null,"我的申请",-1))]),_:1}),t(d,{index:"2",onClick:a[2]||(a[2]=L=>n(m).setCurrentTab("2"))},{default:o(()=>[t(u,null,{default:o(()=>[t(_)]),_:1}),a[10]||(a[10]=l("span",null,"任务列表",-1))]),_:1}),t(d,{index:"3",onClick:a[3]||(a[3]=L=>n(m).setCurrentTab("3"))},{default:o(()=>[t(u,null,{default:o(()=>[t(k)]),_:1}),a[11]||(a[11]=l("span",null,"申请列表",-1))]),_:1}),t(d,{index:"4",onClick:a[4]||(a[4]=L=>n(m).setCurrentTab("4"))},{default:o(()=>[t(u,null,{default:o(()=>[t(h)]),_:1}),a[12]||(a[12]=l("span",null,"历史抄送",-1))]),_:1})]),_:1}),t(b,{index:"approval"},{title:o(()=>[t(u,null,{default:o(()=>[t(n(vt))]),_:1}),a[13]||(a[13]=l("span",null,"审批",-1))]),default:o(()=>[t(d,{index:"5",onClick:a[5]||(a[5]=L=>n(m).setCurrentTab("5"))},{default:o(()=>[t(u,null,{default:o(()=>[t($)]),_:1}),a[14]||(a[14]=l("span",null,"我的审批",-1))]),_:1}),t(d,{index:"6",onClick:a[6]||(a[6]=L=>n(m).setCurrentTab("6"))},{default:o(()=>[t(u,null,{default:o(()=>[t(g)]),_:1}),a[15]||(a[15]=l("span",null,"我的抄送",-1))]),_:1})]),_:1})]),_:1},8,["default-active"])}}});const wo=W(ko,[["__scopeId","data-v-dd582d49"]]),bo=B({__name:"AiChatLeft",setup(I){const e=Ye(),m=async()=>{if(e.searchInput!=""){const a=(await e.getChatList()).filter(r=>{if(r.title.includes(e.searchInput))return r});a.length>0&&(e.chatList=a)}else await e.getChatList()};return(i,a)=>{const r=Oe,u=ue,c=ve,d=U("Plus"),p=Z,_=xe,k=X,h=U("Delete"),b=j,$=de;return s(),f(E,null,[t(u,{modelValue:n(e).showInfo,"onUpdate:modelValue":a[0]||(a[0]=g=>n(e).showInfo=g),width:"600","append-to-body":"",fullscreen:!!n(K)()},{default:o(()=>[t(r)]),_:1},8,["modelValue","fullscreen"]),t($,null,{default:o(()=>[t(_,{class:"search"},{default:o(()=>[t(c,{placeholder:"搜索",onKeyup:We(m,["enter"]),"prefix-icon":n(be),class:"search-input",modelValue:n(e).searchInput,"onUpdate:modelValue":a[1]||(a[1]=g=>n(e).searchInput=g)},null,8,["prefix-icon","modelValue"]),l("button",{class:"add-chat",onClick:a[2]||(a[2]=g=>n(e).showBox(!1))},[t(p,null,{default:o(()=>[t(d)]),_:1})])]),_:1}),(s(!0),f(E,null,G(n(e).chatList,(g,v)=>(s(),f("div",{key:v},[l("div",{class:me(["list-item",{active:g.id===n(e).activeId}])},[t(b,{justify:"space-around"},{default:o(()=>[t(k,{span:20,onClick:ie(L=>n(e).setActiveId(g.id),["stop"]),class:"chat-title"},{default:o(()=>[T(x(g.title),1)]),_:2},1032,["onClick"]),t(k,{span:4,class:"iconlist"},{default:o(()=>[t(p,{size:"15",onClick:ie(L=>n(e).deleteChat(g.id),["stop"])},{default:o(()=>[t(h)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)],2)]))),128))]),_:1})],64)}}});const Co=W(bo,[["__scopeId","data-v-a84b3e0b"]]);const Io={key:0,class:"title"},$o={key:1,class:"title"},xo={key:0},Mo=["onClick"],Do={class:"previewName"},Lo={class:"previewIP"},Vo={key:1},So={key:0,class:"title"},No={key:1,class:"title"},To={key:0,class:"tree-container"},Uo={key:1},Fo={key:0,class:"title"},Eo={key:1,class:"title"},zo={key:0},Ao=["onClick"],Ro={class:"previewName"},Go={key:1},Po={__name:"ChatUserList",setup(I){const e=se(),m=c=>{c.isUser&&e.getSessionInfo(c.id,"user")};function i(c){return c.map(d=>({label:d.dept_name,children:a(d.users).concat(r(d.sub_depts))}))}function a(c){return c?c.map(d=>({label:`${d.nick_name}`,id:d.user_id,isUser:!0,children:[]})):[]}function r(c){return c?i(c):[]}const u=i(e.departmentList);return console.log(u),(c,d)=>{const p=wt;return s(),y(n(kt),{modelValue:n(e).activeNames,"onUpdate:modelValue":d[0]||(d[0]=_=>n(e).activeNames=_)},{default:o(()=>[t(n(we),{name:"1"},{title:o(()=>[n(e).onlineUserList.length>0?(s(),f("span",Io,"在线（"+x(n(e).onlineUserList.length)+"）",1)):(s(),f("span",$o,"在线"))]),default:o(()=>[n(e).onlineUserList.length>0?(s(),f("div",xo,[(s(!0),f(E,null,G(n(e).onlineUserList,_=>(s(),f("div",{key:_.id},[l("div",{class:"list-item",onClick:k=>n(e).getSessionInfo(_.chatId,"user"),style:fe({backgroundColor:_.id===n(e).targetChatId?"#F5F5F5":""})},[t(n(j),null,{default:o(()=>[t(n(X),{span:6},{default:o(()=>[t(n(oe),{shape:"square",size:40,class:"avatar",src:_.avatar},null,8,["src"])]),_:2},1024),t(n(X),{span:18},{default:o(()=>[t(n(j),{style:{display:"flex","align-items":"center"}},{default:o(()=>[t(n(X),null,{default:o(()=>[l("div",Do,x(_.nickname),1)]),_:2},1024),t(n(X),{span:6})]),_:2},1024),t(n(j),null,{default:o(()=>[l("div",Lo,x(_.login_ip),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)],12,Mo)]))),128))])):(s(),f("div",Vo,d[1]||(d[1]=[l("p",{class:"no-data"},"暂无数据",-1)])))]),_:1}),t(n(we),{name:"2"},{title:o(()=>[n(e).departmentList.length>0?(s(),f("span",So," 部门（"+x(n(e).departmentList.length)+"） ",1)):(s(),f("span",No,"部门"))]),default:o(()=>[n(u).length>0?(s(),f("div",To,[t(p,{data:n(u),"node-key":"dept_id",props:{label:"label",children:"children"},onNodeClick:m,"default-expand-all":!1},null,8,["data"])])):(s(),f("div",Uo,d[2]||(d[2]=[l("p",{class:"no-data"},"暂无数据",-1)])))]),_:1}),t(n(we),{name:"3"},{title:o(()=>[n(e).groupList.length>0?(s(),f("span",Fo,"群组（"+x(n(e).groups.length)+"）",1)):(s(),f("span",Eo,"群组"))]),default:o(()=>[n(e).groupList.length>0?(s(),f("div",zo,[(s(!0),f(E,null,G(n(e).groups,_=>(s(),f("div",{key:_.id},[l("div",{class:"list-item",onClick:k=>n(e).getSessionInfo(_.id,"group"),style:fe({backgroundColor:_.id===n(e).targetChatId?"#F5F5F5":""})},[t(n(j),null,{default:o(()=>[t(n(X),{span:6},{default:o(()=>[t(n(oe),{shape:"square",size:40,class:"avatar"},{default:o(()=>d[3]||(d[3]=[T("群")])),_:1})]),_:1}),t(n(X),{span:18},{default:o(()=>[l("div",Ro,x(_.name),1)]),_:2},1024)]),_:2},1024)],12,Ao)]))),128))])):(s(),f("div",Go,d[4]||(d[4]=[l("p",{class:"no-data"},"暂无数据",-1)])))]),_:1})]),_:1},8,["modelValue"])}}},Bo=W(Po,[["__scopeId","data-v-63a40f89"]]);const Yo=["onClick"],Ho={class:"preview-top-content"},qo={class:"previewName"},Wo={class:"previewTime"},Ko={class:"previewChat"},Oo={key:1,class:"emptyChat"},Jo={__name:"ChatMsgList",setup(I){const e=se();C("1");function m(i){const a=new Date(i),r=a.getMonth()+1,u=a.getDate();return`${r}-${u}`}return ce(()=>e.search?e.messages.filter(i=>i.content.toLowerCase().includes(e.search.toLowerCase())):e.messages),(i,a)=>{const r=oe,u=X,c=U("CircleCheckFilled"),d=Z,p=U("CircleCloseFilled"),_=j,k=U("ChatSquare");return(n(e).searchList.length>0?n(e).searchList:n(e).chatList).length>0?(s(!0),f(E,{key:0},G(n(e).searchList.length>0?n(e).searchList:n(e).chatList,h=>(s(),f("div",{key:h.id},[l("div",{class:"list-item",onClick:b=>n(e).getSessionInfo(h.chatId,h.type),style:fe({backgroundColor:h.chatId==n(e).targetChatId?"#E8F3FF":""})},[t(_,null,{default:o(()=>[t(u,{span:6},{default:o(()=>[h.type=="user"?(s(),y(r,{key:0,shape:"square",size:40,class:"avatar",src:h.avatar},null,8,["src"])):h.type=="group"?(s(),y(r,{key:1,shape:"square",size:40,class:"avatar",style:{"background-color":"#165dff",display:"flex","align-items":"center","justify-content":"center"}},{default:o(()=>a[0]||(a[0]=[l("div",{style:{width:"25px",height:"25px","background-image":"url('@/assets/icons/group.png')","background-size":"cover"}},null,-1)])),_:1})):h.type=="system"?(s(),y(r,{key:2,shape:"square",size:40,class:"avatar",icon:"el-icon-message"})):D("",!0)]),_:2},1024),h.online&&h.type=="user"?(s(),y(d,{key:0,style:{position:"absolute",left:"40px",bottom:"5px",color:"#0078d4"}},{default:o(()=>[t(c)]),_:1})):h.type=="user"?(s(),y(d,{key:1,style:{position:"absolute",left:"40px",bottom:"5px",color:"#999999"}},{default:o(()=>[t(p)]),_:1})):D("",!0),t(u,{span:18,class:"preview"},{default:o(()=>[t(_,{class:"preview-content"},{default:o(()=>[t(u,{span:18,class:"preview-left"},{default:o(()=>[l("div",Ho,[l("div",qo,x(h.displayName),1),l("div",Wo,x(m(h.time)),1)]),l("div",Ko,[l("span",null,x(h.previewMessage),1)])]),_:2},1024),t(u,{span:6,class:"preview-right"})]),_:2},1024)]),_:2},1024)]),_:2},1024)],12,Yo)]))),128)):(s(),f("div",Oo,[t(d,{size:60,class:"chat-icon"},{default:o(()=>[t(k)]),_:1}),a[1]||(a[1]=l("p",{class:"empty-message"},"暂无数据",-1))]))}}},Xo=W(Jo,[["__scopeId","data-v-01814aa3"]]);const Zo={class:"menu-icon-box"},jo={class:"menu-icon-box"},Qo={class:"menu-icon-box"},es={class:"menu-icon-box"},ts={key:1,class:"menubar"},ns={__name:"WorkbenchMenu",setup(I){const e=se();return(m,i)=>{const a=oe,r=j,u=Z,c=U("Position");return n(K)()?(s(),f("div",ts,[l("div",{class:"menu-icon-box",onClick:i[4]||(i[4]=d=>n(e).setCurrentNavId(0))},[n(e).currentNavId===0?(s(),y(u,{key:0,class:"menu-icon-on"},{default:o(()=>[t(n(pe))]),_:1})):(s(),y(u,{key:1,class:"menu-icon"},{default:o(()=>[t(n(pe))]),_:1}))]),l("div",{class:"menu-icon-box",onClick:i[5]||(i[5]=d=>n(e).setCurrentNavId(1))},[n(e).currentNavId===1?(s(),y(u,{key:0,class:"menu-icon-on"},{default:o(()=>[t(n(Le))]),_:1})):(s(),y(u,{key:1,class:"menu-icon"},{default:o(()=>[t(n(Ve))]),_:1}))]),l("div",{class:"menu-icon-box",onClick:i[6]||(i[6]=d=>n(e).setCurrentNavId(3))},[n(e).currentNavId===3?(s(),y(u,{key:0,class:"menu-icon-on"},{default:o(()=>[t(n(Se))]),_:1})):(s(),y(u,{key:1,class:"menu-icon"},{default:o(()=>[t(c)]),_:1}))]),l("div",{class:"menu-icon-box",onClick:i[7]||(i[7]=d=>n(e).setCurrentNavId(2))},[n(e).currentNavId===2?(s(),y(u,{key:0,class:"menu-icon-on"},{default:o(()=>[t(n(Ne))]),_:1})):(s(),y(u,{key:1,class:"menu-icon"},{default:o(()=>[t(n(Te))]),_:1}))])])):(s(),f(E,{key:0},[t(r,null,{default:o(()=>[t(a,{shape:"square",size:30,class:"userAvatar",src:n(e).userInfo.avatar},null,8,["src"])]),_:1}),t(r,{onClick:i[0]||(i[0]=d=>n(e).setCurrentNavId(0))},{default:o(()=>[l("div",Zo,[n(e).currentNavId===0?(s(),y(u,{key:0,class:"menu-icon-on"},{default:o(()=>[t(n(pe))]),_:1})):(s(),y(u,{key:1,class:"menu-icon"},{default:o(()=>[t(n(pe))]),_:1}))])]),_:1}),t(r,{onClick:i[1]||(i[1]=d=>n(e).setCurrentNavId(1))},{default:o(()=>[l("div",jo,[n(e).currentNavId===1?(s(),y(u,{key:0,class:"menu-icon-on"},{default:o(()=>[t(n(Le))]),_:1})):(s(),y(u,{key:1,class:"menu-icon"},{default:o(()=>[t(n(Ve))]),_:1}))])]),_:1}),t(r,{onClick:i[2]||(i[2]=d=>n(e).setCurrentNavId(3))},{default:o(()=>[l("div",Qo,[n(e).currentNavId===3?(s(),y(u,{key:0,class:"menu-icon-on"},{default:o(()=>[t(n(Se))]),_:1})):(s(),y(u,{key:1,class:"menu-icon"},{default:o(()=>[t(c)]),_:1}))])]),_:1}),t(r,{onClick:i[3]||(i[3]=d=>n(e).setCurrentNavId(2))},{default:o(()=>[l("div",es,[n(e).currentNavId===2?(s(),y(u,{key:0,class:"menu-icon-on"},{default:o(()=>[t(n(Ne))]),_:1})):(s(),y(u,{key:1,class:"menu-icon"},{default:o(()=>[t(n(Te))]),_:1}))])]),_:1})],64))}}},os=W(ns,[["__scopeId","data-v-1dc96459"]]),ss={key:0},as={key:0},ls={class:"dialog-header"},is={class:"dialog-body"},rs=B({__name:"workbench",setup(I){const e=se();te(()=>{e.initChat()});const m=C(),i=C(!1);return(a,r)=>{const u=os,c=Ct,d=ve,p=U("Plus"),_=Z,k=xe,h=Xo,b=Bo,$=de,g=Ke,v=Co,L=wo,w=bt,z=$e,Y=O,A=yo,V=In,M=_n,P=on,H=re,R=It,S=Ae,J=ue;return s(),y(w,{class:"container"},{default:o(()=>[t(c,{class:"menu"},{default:o(()=>[t(u)]),_:1}),n(e).currentNavId<4?(s(),y(w,{key:0,class:"side"},{default:o(()=>[n(e).currentNavId<2?(s(),f("div",ss,[t(k,{class:"search"},{default:o(()=>[t(d,{placeholder:"搜索","prefix-icon":n(be),class:"search-input",modelValue:n(e).searchInput,"onUpdate:modelValue":r[0]||(r[0]=F=>n(e).searchInput=F)},null,8,["prefix-icon","modelValue"]),l("button",{class:"inviteGroupChats",onClick:r[1]||(r[1]=F=>n(e).setGroupChatInvitedDialogVisible(!0))},[t(_,null,{default:o(()=>[t(p)]),_:1})])]),_:1}),t(g,{class:"list"},{default:o(()=>[t($,null,{default:o(()=>[n(e).currentNavId==0?(s(),y(h,{key:0})):D("",!0),n(e).currentNavId==1?(s(),y(b,{key:1})):D("",!0)]),_:1})]),_:1})])):D("",!0),n(e).currentNavId==3?(s(),y(v,{key:1})):D("",!0),n(e).currentNavId==2?(s(),y(L,{key:2})):D("",!0)]),_:1})):D("",!0),n(K)()?(s(),y(z,{key:1,modelValue:i.value,"onUpdate:modelValue":r[4]||(r[4]=F=>i.value=F),"with-header":!1,direction:"ltr",size:"50%"},{default:o(()=>[n(e).currentNavId<2?(s(),f("div",as,[t(k,{class:"search"},{default:o(()=>[t(d,{placeholder:"搜索","prefix-icon":n(be),class:"search-input",modelValue:n(e).searchInput,"onUpdate:modelValue":r[2]||(r[2]=F=>n(e).searchInput=F)},null,8,["prefix-icon","modelValue"]),l("button",{class:"inviteGroupChats",onClick:r[3]||(r[3]=F=>n(e).setGroupChatInvitedDialogVisible(!0))},[t(_,null,{default:o(()=>[t(p)]),_:1})])]),_:1}),t(g,{class:"list"},{default:o(()=>[t($,null,{default:o(()=>[n(e).currentNavId==0?(s(),y(h,{key:0})):D("",!0),n(e).currentNavId==1?(s(),y(b,{key:1})):D("",!0)]),_:1})]),_:1})])):D("",!0),n(e).currentNavId==3?(s(),y(v,{key:1})):D("",!0),n(e).currentNavId==2?(s(),y(L,{key:2})):D("",!0)]),_:1},8,["modelValue"])):D("",!0),t(w,{class:"chat-box"},{default:o(()=>[n(K)()?(s(),y(Y,{key:0,icon:"Menu",size:"small",onClick:r[5]||(r[5]=F=>i.value=!i.value)})):D("",!0),n(e).currentNavId<1?(s(),y(A,{key:1})):D("",!0),n(e).currentNavId==1?(s(),y(V,{key:2})):D("",!0),n(e).currentNavId==3?(s(),y(M,{key:3})):D("",!0),n(e).currentNavId==2?(s(),y(P,{key:4})):D("",!0)]),_:1}),t(J,{modelValue:n(e).groupChatInvitedDialogVisible,"onUpdate:modelValue":r[11]||(r[11]=F=>n(e).groupChatInvitedDialogVisible=F),title:"创建群聊","align-center":"",fullscreen:!!n(K)(),"show-close":!n(K)(),draggable:""},ze({default:o(()=>[l("div",is,[l("div",null,[t(S,{"label-position":"top"},{default:o(()=>[t(H,{label:"群聊名称:"},{default:o(()=>[t(d,{maxlength:"8","show-word-limit":"",class:"department-name",modelValue:n(e).departmentName,"onUpdate:modelValue":r[8]||(r[8]=F=>n(e).departmentName=F),placeholder:"请输入群聊名称"},null,8,["modelValue"])]),_:1}),t(H,{label:"选择成员:"},{default:o(()=>[t(R,{ref_key:"chooseUserRef",ref:m},null,512)]),_:1})]),_:1})])])]),_:2},[n(K)()?{name:"header",fn:o(()=>[l("div",ls,[t(Y,{style:{"background-color":"#0078d4",color:"#fff"},onClick:r[6]||(r[6]=F=>n(e).groupChatInvitedDialogVisible=!1)},{default:o(()=>r[12]||(r[12]=[T("取消")])),_:1}),r[14]||(r[14]=l("div",{class:"dialog-title"},"创建群聊",-1)),t(Y,{style:{"background-color":"#0078d4",color:"#fff"},onClick:r[7]||(r[7]=F=>n(e).createGroupChat(m.value.receiverId))},{default:o(()=>r[13]||(r[13]=[T("确定")])),_:1})])]),key:"0"}:void 0,n(K)()?void 0:{name:"footer",fn:o(()=>[l("span",null,[t(Y,{style:{"background-color":"#0078d4",color:"#fff"},onClick:r[9]||(r[9]=F=>n(e).groupChatInvitedDialogVisible=!1)},{default:o(()=>r[15]||(r[15]=[T("取消")])),_:1}),t(Y,{style:{"background-color":"#0078d4",color:"#fff"},onClick:r[10]||(r[10]=F=>n(e).createGroupChat(m.value.receiverId))},{default:o(()=>r[16]||(r[16]=[T("确定")])),_:1})])]),key:"1"}]),1032,["modelValue","fullscreen","show-close"])]),_:1})}}});const fs=W(rs,[["__scopeId","data-v-b9ed8655"]]);export{fs as default};
